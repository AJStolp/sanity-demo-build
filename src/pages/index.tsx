import Head from "next/head";
import NavBar from "@/components/navbar";
import { client } from "@/lib/sanity.client";
import type { SanityDocument } from "@sanity/client";
import { PreviewSuspense } from "next-sanity/preview";
import { queryNav } from "@/query/quieries";
import { lazy } from "react";

interface IHome {
  data: SanityDocument[];
  preview: Boolean;
}

const PreviewNavBar = lazy(() => import("../components/preview-navbar"));

export default function Home(props: IHome) {
  return props.preview ? (
    <PreviewSuspense fallback="Loading...">
      <PreviewNavBar query={queryNav} />
    </PreviewSuspense>
  ) : (
    <>
      <Head>
        <title>Anthony Stolp Sanity Demo</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className="">
        <span>
          <NavBar data={props.data} />
        </span>
      </main>
    </>
  );
  // return (
  //   <>
  //     <Head>
  //       <title>Anthony Stolp Sanity Demo</title>
  //       <meta name="description" content="Generated by create next app" />
  //       <meta name="viewport" content="width=device-width, initial-scale=1" />
  //       <link rel="icon" href="/favicon.ico" />
  //     </Head>
  //     <main className="">
  //       <span>
  //         <NavBar data={props.data} />
  //       </span>
  //     </main>
  //   </>
  // );
}

export const getStaticProps = async ({ preview = false }) => {
  if (preview) {
    return { props: { preview } };
  }
  const data = await client.fetch(queryNav);

  return { props: { preview, data } };
};
